##############################
######## Key Variables
##############################
indir: /home/william/pipeline/cell10x/test/rawdata
outdir: /home/william/pipeline/cell10x/test/out
srcdir: &srcdir /home/william/pipeline/cell10x/src
Lsample:
  - test
  - test2
species: &species human
metadata: /home/william/pipeline/cell10x/sample_config/metadata/test.csv
run_tree: False
run_batch_stat: True



##############################
######## Sample Variables
##############################
test:
  mRNA: True
  FB: False
  VDJB: True
  VDJT: True
  Nmin_cell_to_keep_gene: 10
  Nmin_gene_to_keep_cell: 10
  celltype_ref_tissue: common

test2:
  mRNA: False
  FB: True
  VDJB: True
  VDJT: False
  Nmin_cell_to_keep_gene: 10
  Nmin_gene_to_keep_cell: 10
  id2seq:
    HT: 
      PRM: TGATGGCCTATTGGG
      BTI: GTCAACTCTTTAGCG
    NC: 
      OVA: TGCCAGCCCTTTGTA
    BD: 
      BA2#1: ATGCGATCAGACCGA
      BA2#2: CGTATGCGCTTCAAG
      WT#1: CAGCAACTTCATTGT
      WT#2: GGTATAAGAGCTACG
  FB_corr:
      BA2#1: 2
      BA2#2: 2


##############################
######## Default Variables
##############################
# mRNA parse
Nmin_cell_to_keep_gene: 100
Nmin_gene_to_keep_cell: 100
celltype_ref_tissue: immune
Ndim_umap_use: 30

# VDJ parse
ext_numbering: chothia

# FB
FB_read: 'R2'
FB_pattern: '5PNNNNNNNNNN(BC)'
FB_type: 'Antibody Capture'
Nlim_HT: 10
Nratio_HT: 0.9
Nratio_BD: 0.2
Nratio_NC: 0.1

# filter
flt_mode:
  Bcell:
    - mRNA
    - FB
    - VDJB*
  Tcell:
    - mRNA
    - FB
    - VDJT*
mRNA_gene_flt: 10
mRNA_umi_flt: 10
mRNA_mt_percent_flt: 10
VDJB_umi_flt: 5
VDJT_umi_flt: 5
FB_umi_flt: 10

# visualize
show_celltypes_main: 5
show_celltypes: 10

# tree
tree_sample: 100

##############################
######## Resources
##############################
qc_cpus: 2
count_cpus: 3
mRNA_parse_cpus: 2
FB_parse_cpus: 2
VDJB_igblast_cpus: 2
VDJB_changeo_cpus: 2
Bcell_tree_cpus: 4
VDJB_anarci_cpus: 2
VDJB_parse_cpus: 2
VDJT_parse_cpus: 2
filter_cpus: 2
concat_stat_cpus: 2
visualize_cpus: 2
visualize_rmd_cpus: 2


##############################
######## Constant
##############################
# output
count_mRNA_dir: per_sample_outs/{sample}/count/sample_filtered_feature_bc_matrix
count_mRNA_mtx: per_sample_outs/{sample}/metrics_summary.csv
count_FB_raw_dir: multi/count/raw_feature_bc_matrix
count_FB_dir: per_sample_outs/{sample}/count/sample_filtered_feature_bc_matrix
count_FB_mtx: per_sample_outs/{sample}/metrics_summary.csv
count_VDJB_airr: per_sample_outs/{sample}/vdj_b/airr_rearrangement.tsv
count_VDJB_anno: per_sample_outs/{sample}/vdj_b/filtered_contig_annotations.csv
count_VDJB_mtx: per_sample_outs/{sample}/metrics_summary.csv
count_VDJT_airr: per_sample_outs/{sample}/vdj_t/airr_rearrangement.tsv
count_VDJT_anno: per_sample_outs/{sample}/vdj_t/filtered_contig_annotations.csv
count_VDJT_mtx: per_sample_outs/{sample}/metrics_summary.csv



# software
cellranger: !!python/object/apply:os.path.join [*srcdir, "cellranger-7.1.0/bin/cellranger"]

# gene expression reference
gex_ref_dir: &gex_ref_dir !!python/object/apply:pycones.list_join [*species, "-gex-ref"]
gex_ref: !!python/object/apply:os.path.join [*srcdir, *gex_ref_dir]

# VDJ reference
vdj_ref_dir: &vdj_ref_dir !!python/object/apply:pycones.list_join [*species, "-vdj-ref"]
vdj_ref: !!python/object/apply:os.path.join [*srcdir, *vdj_ref_dir]

# celltype reference
celltype_ref_file: &celltype_ref_file !!python/object/apply:pycones.list_join [*species, ".rds"]
celltype_ref: !!python/object/apply:os.path.join [*srcdir, 'celltype-ref', *celltype_ref_file]

# igblast reference
igblast_VDJB_ref_prefix_part1: &igblast_VDJB_ref_prefix_part1 !!python/object/apply:pycones.list_join [*species, "-VDJB"]
igblast_VDJB_ref_prefix_part2: &igblast_VDJB_ref_prefix_part2 !!python/object/apply:pycones.list_join [*species, "_gl_"]
igblast_VDJB_ref_prefix: !!python/object/apply:os.path.join [*srcdir, 'igblast-ref', *igblast_VDJB_ref_prefix_part1, *igblast_VDJB_ref_prefix_part2]
igblast_VDJT_ref_prefix_part1: &igblast_VDJT_ref_prefix_part1 !!python/object/apply:pycones.list_join [*species, "-VDJT"]
igblast_VDJT_ref_prefix_part2: &igblast_VDJT_ref_prefix_part2 !!python/object/apply:pycones.list_join [*species, "_gl_"]
igblast_VDJT_ref_prefix: !!python/object/apply:os.path.join [*srcdir, 'igblast-ref', *igblast_VDJT_ref_prefix_part1, *igblast_VDJT_ref_prefix_part2]

# changeo reference
changeo_VB_ref: !!python/object/apply:os.path.join [*srcdir, 'igblast-ref', *igblast_VDJB_ref_prefix_part1, 'IGV.fasta']
changeo_DB_ref: !!python/object/apply:os.path.join [*srcdir, 'igblast-ref', *igblast_VDJB_ref_prefix_part1, 'IGD.fasta']
changeo_JB_ref: !!python/object/apply:os.path.join [*srcdir, 'igblast-ref', *igblast_VDJB_ref_prefix_part1, 'IGJ.fasta']
changeo_VT_ref: !!python/object/apply:os.path.join [*srcdir, 'igblast-ref', *igblast_VDJT_ref_prefix_part1, 'TRV.fasta']
changeo_DT_ref: !!python/object/apply:os.path.join [*srcdir, 'igblast-ref', *igblast_VDJT_ref_prefix_part1, 'TRD.fasta']
changeo_JT_ref: !!python/object/apply:os.path.join [*srcdir, 'igblast-ref', *igblast_VDJT_ref_prefix_part1, 'TRJ.fasta']

# igblast auxiliary
igblast_aux_file: &igblast_aux_file !!python/object/apply:pycones.list_join [*species, "_gl.aux"]
igblast_aux: !!python/object/apply:os.path.join [*srcdir, 'igblast-aux', *igblast_aux_file]